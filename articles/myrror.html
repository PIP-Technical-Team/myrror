<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>myrror • myrror</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="myrror">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">myrror</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/myrror.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/large_survey.html">Workflow for Large Surveys</a></li>
  </ul>
</li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>myrror</h1>
            
      

      <div class="d-none name"><code>myrror.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://giorgiacek.github.io/myrror/">myrror</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p><a href="https://giorgiacek.github.io/myrror/">myrror</a> is a package that helps you compare two data
frames.</p>
<p>It has three types of functions:</p>
<ol style="list-style-type: decimal">
<li><p><strong>Complete comparison</strong>: <code><a href="../reference/myrror.html">myrror()</a></code>, the
“workhorse” function which will go through a complete comparison of two
datastes.</p></li>
<li>
<p><strong>Partial comparison</strong>:</p>
<ul>
<li><p><code><a href="../reference/compare_type.html">compare_type()</a></code>: Compares the types of the columns in
the two data frames.</p></li>
<li><p><code><a href="../reference/compare_values.html">compare_values()</a></code>: Compares the values of the columns
in the two data frames.</p></li>
</ul>
</li>
<li>
<p><strong>Extract differences</strong>: two functions which allow
you to access the rows that differ in values between the two data
frames.</p>
<ul>
<li><p><code><a href="../reference/extract_diff_values.html">extract_diff_values()</a></code>: Returns the differences in a
list format, one table per variable.</p></li>
<li><p><code><a href="../reference/extract_diff_table.html">extract_diff_table()</a></code>: Returns the differences in a
table format, all variables.</p></li>
</ul>
</li>
</ol>
<p>For all of this functions, the results will be displayed
interactively in the console. ALternatively, the user has the option to
return the results as an object to use in further analysis.</p>
</div>
<div class="section level2">
<h2 id="workflow-example-1">Workflow Example 1<a class="anchor" aria-label="anchor" href="#workflow-example-1"></a>
</h2>
<p>One use case of the package is to check whether two versions of the
same dataset have any discrepancies. If so, the objective of
<code>myrror</code> is to help the user to quickly identify which
variables, values or observations are different.</p>
<p>In this example, we will compare one simulated dataset
<code>survey_data</code> with a second version,
<code>survey_data_2</code>. Each row is uniquely identified by two
variables, <code>country</code> and <code>year</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_data</span></span>
<span><span class="co">#&gt;     country  year   variable1  variable2   variable3   variable4</span></span>
<span><span class="co">#&gt;      &lt;char&gt; &lt;int&gt;       &lt;num&gt;      &lt;num&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:       A  2010 -0.56047565  0.4978505  0.89512566  0.77996512</span></span>
<span><span class="co">#&gt;  2:       A  2011 -0.23017749 -1.9666172  0.87813349 -0.08336907</span></span>
<span><span class="co">#&gt;  3:       A  2012  1.55870831  0.7013559  0.82158108  0.25331851</span></span>
<span><span class="co">#&gt;  4:       A  2013  0.07050839 -0.4727914  0.68864025 -0.02854676</span></span>
<span><span class="co">#&gt;  5:       A  2014  0.12928774 -1.0678237  0.55391765 -0.04287046</span></span>
<span><span class="co">#&gt;  6:       A  2015  1.71506499 -0.2179749 -0.06191171  1.36860228</span></span>
<span><span class="co">#&gt;  7:       A  2016  0.46091621 -1.0260044 -0.30596266 -0.22577099</span></span>
<span><span class="co">#&gt;  8:       A  2017 -1.26506123 -0.7288912 -0.38047100  1.51647060</span></span>
<span><span class="co">#&gt;  9:       B  2010 -0.68685285 -0.6250393 -0.69470698 -1.54875280</span></span>
<span><span class="co">#&gt; 10:       B  2011 -0.44566197 -1.6866933 -0.20791728  0.58461375</span></span>
<span><span class="co">#&gt; 11:       B  2012  1.22408180  0.8377870 -1.26539635  0.12385424</span></span>
<span><span class="co">#&gt; 12:       B  2013  0.35981383  0.1533731  2.16895597  0.21594157</span></span>
<span><span class="co">#&gt; 13:       B  2014  0.40077145 -1.1381369  1.20796200  0.37963948</span></span>
<span><span class="co">#&gt; 14:       B  2015  0.11068272  1.2538149 -1.12310858 -0.50232345</span></span>
<span><span class="co">#&gt; 15:       B  2016 -0.55584113  0.4264642 -0.40288484 -0.33320738</span></span>
<span><span class="co">#&gt; 16:       B  2017  1.78691314 -0.2950715 -0.46665535 -1.01857538</span></span></code></pre></div>
<p>The second dataset is just a variation of the first one:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">survey_data_2</span></span>
<span><span class="co">#&gt;     country  year   variable1   variable2   variable3   variable4</span></span>
<span><span class="co">#&gt;      &lt;char&gt; &lt;int&gt;       &lt;num&gt;       &lt;num&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1:       A  2010 -0.56047565 -1.07179123  0.89512566  0.77996512</span></span>
<span><span class="co">#&gt;  2:       A  2011 -0.23017749  0.30352864  0.87813349 -0.08336907</span></span>
<span><span class="co">#&gt;  3:       A  2012  1.55870831  0.44820978  0.82158108  0.25331851</span></span>
<span><span class="co">#&gt;  4:       A  2013  0.07050839  0.05300423  0.68864025 -0.02854676</span></span>
<span><span class="co">#&gt;  5:       A  2014  0.12928774  0.92226747  0.55391765 -0.04287046</span></span>
<span><span class="co">#&gt;  6:       A  2015  1.71506499  2.05008469 -0.06191171  1.36860228</span></span>
<span><span class="co">#&gt;  7:       A  2016  0.46091621 -0.49103117 -0.30596266 -0.22577099</span></span>
<span><span class="co">#&gt;  8:       A  2017 -1.26506123 -2.30916888 -0.38047100  1.51647060</span></span>
<span><span class="co">#&gt;  9:       B  2010 -0.68685285  1.00573852 -0.69470698 -1.54875280</span></span>
<span><span class="co">#&gt; 10:       B  2011 -0.44566197 -0.70920076 -0.20791728  0.58461375</span></span>
<span><span class="co">#&gt; 11:       B  2012  1.22408180 -0.68800862 -1.26539635  0.12385424</span></span>
<span><span class="co">#&gt; 12:       B  2013  0.35981383  1.02557137  2.16895597  0.21594157</span></span>
<span><span class="co">#&gt; 13:       B  2014  0.40077145 -0.28477301  1.20796200  0.37963948</span></span>
<span><span class="co">#&gt; 14:       B  2015  0.11068272 -1.22071771 -1.12310858 -0.50232345</span></span>
<span><span class="co">#&gt; 15:       B  2016 -0.55584113  0.18130348 -0.40288484 -0.33320738</span></span>
<span><span class="co">#&gt; 16:       B  2017  1.78691314 -0.13889136 -0.46665535 -1.01857538</span></span></code></pre></div>
<p>And it clearly has different values in <code>variable2</code>:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">survey_data</span>, <span class="va">survey_data_2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Column 'variable2': Mean relative difference: 1.506422"</span></span></code></pre></div>
<p><code><a href="../reference/myrror.html">myrror()</a></code> helps the user diagnosing this difference. To
get a complete report of the differences between
<code>survey_data</code> and <code>survey_data_2</code> the user can
run:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/myrror.html">myrror</a></span><span class="op">(</span><span class="va">survey_data</span>, <span class="va">survey_data_2</span>, </span>
<span>       by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span> </span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">Myrror Report</span> <span style="color: #00BBBB;">───────────────────────────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">General Information:</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">dfx</span>: <span style="color: #00BB00;">survey_data</span> with 16 rows and 6 columns.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">dfy</span>: <span style="color: #00BB00;">survey_data_2</span> with 16 rows and 6 columns.</span></span>
<span><span class="co">#&gt; <span style="font-weight: bold;">Keys</span>: country and year.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Note: comparison is done for shared columns and rows.</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Total shared columns (no keys): 4</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Non-shared columns in survey_data: 2 (country and year)</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Non-shared columns in survey_data_2: 2 ()</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> Total shared rows: 16</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Non-shared rows in survey_data: 0.</span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> Non-shared rows in survey_data_2: 0.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">1. Shared Columns Class Comparison</span> <span style="color: #00BBBB;">──────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> All shared columns have the same class.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">──</span> <span style="font-weight: bold;">2. Shared Columns Values Comparison</span> <span style="color: #00BBBB;">─────────────────────────────────────────</span></span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> 1 shared column(s) have different value(s):</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Note: character-numeric comparison is allowed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Overview:</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;    variable change_in_value na_to_value value_to_na</span></span>
<span><span class="co">#&gt; 1 variable2              16           0           0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="font-weight: bold;">Value comparison:</span> ──</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #BBBB00;">!</span> 1 shared column(s) have different value(s):</span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Note: Only first 5 rows shown for each variable.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; ── <span style="color: #0000BB;">"variable2"</span></span></span>
<span><span class="co">#&gt;               diff indexes variable2.x variable2.y</span></span>
<span><span class="co">#&gt;             &lt;char&gt;  &lt;char&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt; 1: change_in_value       1   0.4978505  -1.0717912</span></span>
<span><span class="co">#&gt; 2: change_in_value      10  -1.6866933  -0.7092008</span></span>
<span><span class="co">#&gt; 3: change_in_value      11   0.8377870  -0.6880086</span></span>
<span><span class="co">#&gt; 4: change_in_value      12   0.1533731   1.0255714</span></span>
<span><span class="co">#&gt; 5: change_in_value      13  -1.1381369  -0.2847730</span></span>
<span><span class="co">#&gt; ...</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BBBB;">ℹ</span> Note: run `extract_diff_values()` or `extract_diff_table()` to access the results in list or table format.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; <span style="color: #00BB00;">✔</span> End of Myrror Report.</span></span></code></pre></div>
<p>By setting the <code>by</code> argument, the user can specify the
unique keys that identify each row. This is useful when the user wants
to compare two datasets that have the same structure but different order
or number of rows.</p>
<p>Once the user identifies the differences, they can use the
<code><a href="../reference/extract_diff_values.html">extract_diff_values()</a></code> function to extract the rows that
differ in values between the two data frames:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_diff_values.html">extract_diff_values</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt; Last myrror object used for comparison.</span></span>
<span><span class="co">#&gt; $variable2</span></span>
<span><span class="co">#&gt;                diff indexes variable2.x variable2.y</span></span>
<span><span class="co">#&gt;              &lt;char&gt;  &lt;char&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1: change_in_value       1   0.4978505 -1.07179123</span></span>
<span><span class="co">#&gt;  2: change_in_value      10  -1.6866933 -0.70920076</span></span>
<span><span class="co">#&gt;  3: change_in_value      11   0.8377870 -0.68800862</span></span>
<span><span class="co">#&gt;  4: change_in_value      12   0.1533731  1.02557137</span></span>
<span><span class="co">#&gt;  5: change_in_value      13  -1.1381369 -0.28477301</span></span>
<span><span class="co">#&gt;  6: change_in_value      14   1.2538149 -1.22071771</span></span>
<span><span class="co">#&gt;  7: change_in_value      15   0.4264642  0.18130348</span></span>
<span><span class="co">#&gt;  8: change_in_value      16  -0.2950715 -0.13889136</span></span>
<span><span class="co">#&gt;  9: change_in_value       2  -1.9666172  0.30352864</span></span>
<span><span class="co">#&gt; 10: change_in_value       3   0.7013559  0.44820978</span></span>
<span><span class="co">#&gt; 11: change_in_value       4  -0.4727914  0.05300423</span></span>
<span><span class="co">#&gt; 12: change_in_value       5  -1.0678237  0.92226747</span></span>
<span><span class="co">#&gt; 13: change_in_value       6  -0.2179749  2.05008469</span></span>
<span><span class="co">#&gt; 14: change_in_value       7  -1.0260044 -0.49103117</span></span>
<span><span class="co">#&gt; 15: change_in_value       8  -0.7288912 -2.30916888</span></span>
<span><span class="co">#&gt; 16: change_in_value       9  -0.6250393  1.00573852</span></span></code></pre></div>
<p>The function <code><a href="../reference/extract_diff_values.html">extract_diff_values()</a></code> operates on the
comparison object created by <code><a href="../reference/myrror.html">myrror()</a></code> and stored in the
environment. If the user wants to extract the differences from a
different comparison, one can simply re-run
<code><a href="../reference/extract_diff_values.html">extract_diff_values()</a></code> with the appropriate arguments, for
example:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_diff_values.html">extract_diff_values</a></span><span class="op">(</span><span class="va">survey_data</span>, <span class="va">survey_data_2</span>, </span>
<span>                    by <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"country"</span>, <span class="st">"year"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $variable2</span></span>
<span><span class="co">#&gt;                diff indexes variable2.x variable2.y</span></span>
<span><span class="co">#&gt;              &lt;char&gt;  &lt;char&gt;       &lt;num&gt;       &lt;num&gt;</span></span>
<span><span class="co">#&gt;  1: change_in_value       1   0.4978505 -1.07179123</span></span>
<span><span class="co">#&gt;  2: change_in_value      10  -1.6866933 -0.70920076</span></span>
<span><span class="co">#&gt;  3: change_in_value      11   0.8377870 -0.68800862</span></span>
<span><span class="co">#&gt;  4: change_in_value      12   0.1533731  1.02557137</span></span>
<span><span class="co">#&gt;  5: change_in_value      13  -1.1381369 -0.28477301</span></span>
<span><span class="co">#&gt;  6: change_in_value      14   1.2538149 -1.22071771</span></span>
<span><span class="co">#&gt;  7: change_in_value      15   0.4264642  0.18130348</span></span>
<span><span class="co">#&gt;  8: change_in_value      16  -0.2950715 -0.13889136</span></span>
<span><span class="co">#&gt;  9: change_in_value       2  -1.9666172  0.30352864</span></span>
<span><span class="co">#&gt; 10: change_in_value       3   0.7013559  0.44820978</span></span>
<span><span class="co">#&gt; 11: change_in_value       4  -0.4727914  0.05300423</span></span>
<span><span class="co">#&gt; 12: change_in_value       5  -1.0678237  0.92226747</span></span>
<span><span class="co">#&gt; 13: change_in_value       6  -0.2179749  2.05008469</span></span>
<span><span class="co">#&gt; 14: change_in_value       7  -1.0260044 -0.49103117</span></span>
<span><span class="co">#&gt; 15: change_in_value       8  -0.7288912 -2.30916888</span></span>
<span><span class="co">#&gt; 16: change_in_value       9  -0.6250393  1.00573852</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="workflow-example-2">Workflow Example 2<a class="anchor" aria-label="anchor" href="#workflow-example-2"></a>
</h2>
<p>Again, we want to compare two datasets: <code>survey_data</code> and
<code>survey_data_4</code>:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">survey_data</span>, <span class="va">survey_data_4</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] "Different number of rows"</span></span></code></pre></div>
<p>These two datasets have a different number of rows.
<code><a href="../reference/myrror.html">myrror()</a></code> can help by identifying the different number of
rows, while also providing a complete report of the differences between
the two datasets.</p>
<p>The user can then extract the rows missing from one of the two
datasets:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co">#extract_diff_rows(survey_data, survey_data_4, </span></span>
<span><span class="co">#                  by=c("country", "year"))</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Giorgia Cecchinato.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
